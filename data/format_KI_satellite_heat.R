setwd("/Users/Dani/Documents/Data_Analysis/KI_Platy/")

temp <- read.csv("data/temperature/thistout_kiritimati.csv", sep=",", header=FALSE)
mtime <- read.csv("data/temperature/timevec_kiritimati.csv", sep=",", header=FALSE)
dhw <- read.csv("data/temperature/histout_kiritimati.csv", sep=",", header=FALSE)
time <- "NA"

KI_satellite_heat <- cbind(temp,mtime,dhw,time)
colnames(KI_satellite_heat) <- c("temp","mtime","dhw","time")
head(KI_satellite_heat)

matlab2POS = function(x, timez = "UTC") {
  days = x - 719529 	# 719529 = days from 1-1-0000 to 1-1-1970
  secs = days * 86400 # 86400 seconds in a day
  # This next string of functions is a complete disaster, but it works.
  # It tries to outsmart R by converting the secs value to a POSIXct value
  # in the UTC time zone, then converts that to a time/date string that 
  # should lose the time zone, and then it performs a second as.POSIXct()
  # conversion on the time/date string to get a POSIXct value in the user's 
  # specified timezone. Time zones are a goddamned nightmare.
  return(as.POSIXct(strftime(as.POSIXct(secs, origin = '1970-1-1', 
                                        tz = 'UTC'), format = '%Y-%m-%d %H:%M', 
                             tz = 'UTC', usetz = FALSE), tz = timez))
}

KI_satellite_heat$time <- matlab2POS(KI_satellite_heat$mtime)
KI_satellite_heat$time <- as.Date(KI_satellite_heat$time, '%m/%d/%Y',tz="UTC")

save(KI_satellite_heat,file="data/KI_satellite_heat.RData")
